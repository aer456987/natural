(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e51dccc"],{1593:function(t,e,c){"use strict";c.r(e);c("b0c0"),c("99af");var a=c("7a23"),r={class:"container pageContent py-5 overflow-auto"},s=Object(a["h"])("h1",{class:"text-center fw-bold m-0 pb-5"},"訂單管理",-1),n={class:"row justify-content-between pb-2"},o={class:"col-md-6 col-lg-6 pb-1"},d={class:"row"},l={class:"col-5"},i={class:" input-group"},b={class:"col-lg-6 text-end pb-1"},h=Object(a["h"])("i",{class:"bi bi-arrow-counterclockwise"},null,-1),O={class:"table-responsive"},u={class:"table table-hover rounded overflow-hidden shadow-sm\n          text-break text-center"},p=Object(a["h"])("thead",{class:"table-dark align-middle"},[Object(a["h"])("tr",null,[Object(a["h"])("td",{width:"10%"},"建立時間"),Object(a["h"])("td",{width:"15%"},"訂單編號"),Object(a["h"])("td",{width:"10%"},"訂購人"),Object(a["h"])("td",{width:"12%"},"Email"),Object(a["h"])("td",{width:"15%"},"訂單內容"),Object(a["h"])("td",{width:"8%"},"總金額"),Object(a["h"])("td",{width:"8%"},"付款狀態"),Object(a["h"])("td",{width:"8%"},"處理進度"),Object(a["h"])("td",{width:"7%"},"操作"),Object(a["h"])("td",{width:"7%"},"刪除")])],-1),j={"data-title":"建立時間"},m={"data-title":"訂單編號",class:"text-warning"},f={"data-title":"訂購人"},g={"data-title":"Email"},w={"data-title":"訂單內容",class:"text-start"},x={"data-title":"總金額"},y={"data-title":"處理進度"},v={key:1,class:"text-gray"},_={"data-title":"操作"},S={"data-title":"刪除"};function k(t,e,c,k,B,M){var N=Object(a["y"])("DashboarLoading"),$=Object(a["y"])("Pagination"),E=Object(a["y"])("OrderModal");return Object(a["t"])(),Object(a["d"])(a["a"],null,[Object(a["h"])(N,{status:B.loadingStatus},null,8,["status"]),Object(a["h"])("section",r,[s,Object(a["h"])("div",n,[Object(a["h"])("div",o,[Object(a["h"])("div",d,[Object(a["h"])("span",l,[Object(a["h"])("span",i,[Object(a["L"])(Object(a["h"])("input",{type:"text",class:"form-control",placeholder:"請輸入訂單編號","aria-label":"search","aria-describedby":"basic-addon1","onUpdate:modelValue":e[1]||(e[1]=function(t){return B.orderSearch=t})},null,512),[[a["H"],B.orderSearch]]),Object(a["h"])("i",{class:"bi bi-x-lg fs-6 btn btn-outline-brown input-group-text",onClick:e[2]||(e[2]=function(){return M.clearSearch&&M.clearSearch.apply(M,arguments)})})])])])]),Object(a["h"])("div",b,[Object(a["h"])("button",{class:"btn btn-outline-danger",onClick:e[3]||(e[3]=function(t){return M.delAllOrderSwalFn("all")})}," 刪除全部訂單 "),Object(a["h"])("button",{type:"button",class:"btn btn-outline-brown btn-sm fs-5 ms-1",onClick:e[4]||(e[4]=function(){return M.resetData&&M.resetData.apply(M,arguments)})},[h])])]),Object(a["h"])("div",O,[Object(a["h"])("table",u,[p,Object(a["h"])("tbody",null,[(Object(a["t"])(!0),Object(a["d"])(a["a"],null,Object(a["x"])(M.filterOrder,(function(e){return Object(a["t"])(),Object(a["d"])("tr",{key:e.id},[Object(a["h"])("td",j,Object(a["B"])(t.$filters.date(e.create_at)),1),Object(a["h"])("td",m,Object(a["B"])(e.id),1),Object(a["h"])("td",f,Object(a["B"])(e.user.name),1),Object(a["h"])("td",g,Object(a["B"])(e.user.email),1),Object(a["h"])("td",w,[(Object(a["t"])(!0),Object(a["d"])(a["a"],null,Object(a["x"])(e.products,(function(t){return Object(a["t"])(),Object(a["d"])("p",{key:t.id,class:"m-0"},Object(a["B"])("".concat(t.product.title," x ").concat(t.qty).concat(t.product.unit)),1)})),128))]),Object(a["h"])("td",x," $ "+Object(a["B"])(t.$filters.currency(e.total)),1),Object(a["h"])("td",{"data-title":"付款狀態",class:{"text-gray":!e.is_paid},title:"付款日期： ".concat(t.$filters.date(e.paid_date))},Object(a["B"])(e.is_paid?"已付款":"未付款"),11,["title"]),Object(a["h"])("td",y,["貨到付款"===e.user.payment||e.is_paid?(Object(a["t"])(),Object(a["d"])("span",{key:0,class:["m-0",{"text-warning":e.is_consignment,"text-success":!e.is_consignment}]},Object(a["B"])(e.is_consignment?"已出貨":"處理中"),3)):(Object(a["t"])(),Object(a["d"])("span",v," 訂單成立 "))]),Object(a["h"])("td",_,[Object(a["h"])("button",{class:"btn btn-outline-brown px-2 py-1",onClick:function(t){return M.openOrderModal(e)}}," 更多 ",8,["onClick"])]),Object(a["h"])("td",S,[Object(a["h"])("i",{class:"bi bi-trash-fill btn btn-outline-danger",onClick:function(t){return M.delOrderSwalFn(e,"one")}},null,8,["onClick"])])])})),128))])])]),Object(a["h"])($,{"pagination-page":B.ordersPagination,onGetData:M.getOrders},null,8,["pagination-page","onGetData"]),Object(a["h"])(E,{ref:"orderModal","modal-order":B.tempOrderData,onModalUpdateOrderPaid:M.updateOrderPaid},null,8,["modal-order","onModalUpdateOrderPaid"])])],64)}c("4de4"),c("ac1f"),c("466d");var B=c("4897"),M=c("29f8"),N=c("38b6"),$={class:"modal fade",id:"orderFirstModal",tabindex:"-1","aria-hidden":"true",ref:"modal"},E={class:"modal-dialog modal-dialog-centered"},I={class:"modal-content"},D=Object(a["h"])("div",{class:"modal-header bg-warning text-brown-500"},[Object(a["h"])("h5",{class:"modal-title",id:"orderModalLabel"},"修改訂單"),Object(a["h"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),P={class:"modal-body px-md-5"},C={class:"row"},A={class:"col-12"},F=Object(a["h"])("h1",{class:"h4 text-center my-2"},"訂購人資訊",-1),L={class:"table border rounded shadow-sm text-break"},U=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," 姓名 ",-1),V={class:"px-2"},T=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," 電話 ",-1),G={class:"px-2"},J=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," Email ",-1),R={class:"px-2"},X=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," 寄送方式 ",-1),Y={class:"px-2"},q=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," 寄送地址 ",-1),H={class:"px-2"},z=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," 備註 ",-1),K={class:"px-2"},Q={class:"col-12 p-2"},W=Object(a["h"])("h1",{class:"h4 text-center my-2"},"訂單資訊",-1),Z={class:"table border rounded shadow-sm text-break"},tt=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," 訂單編號 ",-1),et={class:"px-2"},ct=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," 訂單成立時間 ",-1),at={class:"px-2"},rt=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," 訂單總金額 ",-1),st={class:"px-2"},nt=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," 付款方式 ",-1),ot={class:"px-2"},dt=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," 付款狀態 ",-1),lt={class:"px-2"},it={for:"isPaid_status"},bt=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," 付款時間 ",-1),ht={class:"px-2"},Ot=Object(a["h"])("th",{scope:"row",class:"px-2",width:"25%"}," 處理進度 ",-1),ut={class:"px-2"},pt={key:1,class:"text-gray"},jt={class:"col-12 p-2 text-center"},mt=Object(a["h"])("h1",{class:"h4 text-center my-2"},"購買明細",-1),ft={class:"table border rounded shadow-sm text-break"},gt=Object(a["h"])("thead",{class:"border-bottom"},[Object(a["h"])("th",{scope:"row",class:"py-1"}," 品名 "),Object(a["h"])("th",{scope:"row",class:"py-1"}," 數量 "),Object(a["h"])("th",{scope:"row",class:"py-1"}," 售價 "),Object(a["h"])("th",{scope:"row",class:"py-1"}," 折扣 "),Object(a["h"])("th",{scope:"row",class:"py-1"}," 小計 ")],-1),wt={class:"col-12 form-check\n                d-flex justify-content-end align-items-center"},xt=Object(a["h"])("label",{for:"consignment_status"}," 商品出貨 ",-1),yt={class:"modal-footer"},vt=Object(a["h"])("button",{type:"button",class:"btn btn-outline-brown","data-bs-dismiss":"modal"},"關閉",-1);function _t(t,e,c,r,s,n){return Object(a["t"])(),Object(a["d"])("section",$,[Object(a["h"])("section",E,[Object(a["h"])("main",I,[D,Object(a["h"])("div",P,[Object(a["h"])("div",C,[Object(a["h"])("div",A,[F,Object(a["h"])("table",L,[Object(a["h"])("tbody",null,[Object(a["h"])("tr",null,[U,Object(a["h"])("td",V,Object(a["B"])(s.tempOrder.user.name),1)]),Object(a["h"])("tr",null,[T,Object(a["h"])("td",G,Object(a["B"])(s.tempOrder.user.tel),1)]),Object(a["h"])("tr",null,[J,Object(a["h"])("td",R,Object(a["B"])(s.tempOrder.user.email),1)]),Object(a["h"])("tr",null,[X,Object(a["h"])("td",Y,Object(a["B"])(s.tempOrder.user.delivery),1)]),Object(a["h"])("tr",null,[q,Object(a["h"])("td",H,Object(a["B"])(s.tempOrder.user.address),1)]),Object(a["h"])("tr",null,[z,Object(a["h"])("td",K,Object(a["B"])(s.tempOrder.message?s.tempOrder.message:"無"),1)])])])]),Object(a["h"])("div",Q,[W,Object(a["h"])("table",Z,[Object(a["h"])("tbody",null,[Object(a["h"])("tr",null,[tt,Object(a["h"])("td",et,Object(a["B"])(s.tempOrder.id),1)]),Object(a["h"])("tr",null,[ct,Object(a["h"])("td",at,Object(a["B"])(t.$filters.date(s.tempOrder.create_at)),1)]),Object(a["h"])("tr",null,[rt,Object(a["h"])("td",st," $ "+Object(a["B"])(t.$filters.currency(s.tempOrder.total))+" 元 ",1)]),Object(a["h"])("tr",null,[nt,Object(a["h"])("td",ot,Object(a["B"])(s.tempOrder.user.payment),1)]),Object(a["h"])("tr",null,[dt,Object(a["h"])("td",lt,[Object(a["h"])("span",{class:["form-check",{"text-warning":s.tempOrder.is_paid,"text-gray":!s.tempOrder.is_paid}]},[Object(a["L"])(Object(a["h"])("input",{type:"checkbox",id:"isPaid_status",class:"form-check-input me-1",name:"付款狀態",value:"付款狀態","onUpdate:modelValue":e[1]||(e[1]=function(t){return s.tempOrder.is_paid=t})},null,512),[[a["E"],s.tempOrder.is_paid]]),Object(a["h"])("label",it,Object(a["B"])(s.tempOrder.is_paid?"已付款":"未付款"),1)],2)])]),Object(a["h"])("tr",null,[bt,Object(a["h"])("td",ht,Object(a["B"])(t.$filters.date(s.tempOrder.paid_date)),1)]),Object(a["h"])("tr",null,[Ot,Object(a["h"])("td",ut,[s.orderStatus?(Object(a["t"])(),Object(a["d"])("span",{key:0,class:["m-0",{"text-warning":s.tempOrder.is_consignment,"text-success":!s.tempOrder.is_consignment}]},Object(a["B"])(s.tempOrder.is_consignment?"已出貨":"處理中"),3)):(Object(a["t"])(),Object(a["d"])("span",pt," 訂單成立 "))])])])])]),Object(a["h"])("div",jt,[mt,Object(a["h"])("table",ft,[gt,Object(a["h"])("tbody",null,[(Object(a["t"])(!0),Object(a["d"])(a["a"],null,Object(a["x"])(s.tempOrder.products,(function(e){return Object(a["t"])(),Object(a["d"])("tr",{key:e.product_id},[Object(a["h"])("td",null,Object(a["B"])(e.product.title),1),Object(a["h"])("td",null,Object(a["B"])(e.product.num)+" "+Object(a["B"])(e.product.unit),1),Object(a["h"])("td",null," $"+Object(a["B"])(t.$filters.currency(e.product.price)),1),Object(a["h"])("td",null,Object(a["B"])(e.coupon.percent?e.coupon.percent+"%":"無"),1),Object(a["h"])("td",null," $ "+Object(a["B"])(t.$filters.currency(e.final_total)),1)])})),128))])])]),Object(a["h"])("span",wt,[Object(a["L"])(Object(a["h"])("input",{type:"checkbox",id:"consignment_status",class:"form-check-input me-1",name:"處理進度",value:"處理進度","onUpdate:modelValue":e[2]||(e[2]=function(t){return s.tempOrder.is_consignment=t})},null,512),[[a["E"],s.tempOrder.is_consignment]]),xt])])]),Object(a["h"])("div",yt,[Object(a["h"])("button",{type:"button",onClick:e[3]||(e[3]=function(e){return t.$emit("modalUpdateOrderPaid",s.tempOrder)}),class:"btn btn-warning text-brown-500"},"變更訂單狀態"),vt])])])],512)}c("a9e3");var St=c("7c2b"),kt=c.n(St),Bt={name:"DashboarOrderModal",props:["modalOrder"],data:function(){return{orderModal:"",orderStatus:!1,tempOrder:{create_at:Number,id:"",is_paid:Boolean,paid_date:Number,products:{},total:Number,user:{name:"",email:"",tel:"",address:"",payment:""}}}},watch:{modalOrder:function(){this.tempOrder=this.modalOrder,"貨到付款"===this.modalOrder.user.payment||this.modalOrder.is_paid?this.orderStatus=!0:this.orderStatus=!1}},emits:["modalUpdateOrderPaid"],methods:{openOrderModal:function(){this.orderModal.show()},hideOderModal:function(){this.orderModal.hide()}},mounted:function(){this.orderModal=new kt.a(this.$refs.modal)}};Bt.render=_t;var Mt=Bt,Nt={name:"DashboardOrders",data:function(){return{loadingStatus:!1,orderSearch:"",ordersPagination:{},orders:[],tempOrderData:{}}},computed:{filterOrder:function(){var t=this;return this.orders.filter((function(e){return e.id.match(t.orderSearch)}))}},components:{DashboarLoading:M["a"],Pagination:N["a"],OrderModal:Mt},methods:{getOrders:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("toriha_vuetestapi","/admin/orders?page=").concat(e);this.loadingStatus=!0,this.$http.get(c).then((function(e){e.data.success?(console.log("(成功-後台)取得訂單 res",e),t.orders=e.data.orders,t.ordersPagination=e.data.pagination,t.loadingStatus=!1,console.log("(成功-後台)取得訂單 vue",t.ordersPagination,t.orders)):(console.log("(錯誤-後台)取得訂單 res",e),t.loadingStatus=!1)})).catch((function(e){console.log("(失敗-後台)取得訂單 err"),console.dir(e),t.loadingStatus=!1}))},delOrder:function(t,e){var c=this,a="";this.loadingStatus=!0,"all"===t?a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("toriha_vuetestapi","/admin/orders/all"):"one"===t&&(a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("toriha_vuetestapi","/admin/order/").concat(e)),this.$http.delete(a).then((function(t){t.data.success?(console.log("(成功-後台)刪除訂單 res",t),c.getOrders(),Object(B["c"])(t.data.message,"success")):(console.log("(錯誤-後台)刪除訂單 res",t),Object(B["c"])(t.data.message,"error"),c.loadingStatus=!1)})).catch((function(t){console.log("(失敗-後台)刪除訂單 err"),console.dir(t),c.loadingStatus=!1}))},delOrderSwalFn:function(t,e){var c=t.id;Object(B["a"])(c,c,this.delOrder,e)},delAllOrderSwalFn:function(t){Object(B["b"])(t,this.delOrder)},updateOrderPaid:function(t){var e=this,c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("toriha_vuetestapi","/admin/order/").concat(t.id);this.loadingStatus=!0,t.is_paid?this.tempOrderData.paid_date=Date.parse(new Date)/1e3:this.tempOrderData.paid_date=null,this.$http.put(c,{data:t}).then((function(t){t.data.success?(console.log("(成功-後台)修改訂單 res",t),e.$refs.orderModal.hideOderModal(),Object(B["c"])(t.data.message,"success"),e.getOrders()):(console.log("(錯誤-後台)修改訂單 res",t),Object(B["c"])(t.data.message,"error"),e.loadingStatus=!1)})).catch((function(t){console.log("(失敗-後台)修改訂單 err"),console.dir(t),e.loadingStatus=!1}))},openOrderModal:function(t){this.tempOrderData=JSON.parse(JSON.stringify(t)),this.$refs.orderModal.openOrderModal()},resetData:function(){Object(B["c"])("正在重整資料","info"),this.clearSearch(),this.getOrders()},clearSearch:function(){this.orderSearch=""}},mounted:function(){this.getOrders()}};Nt.render=k;e["default"]=Nt},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,c){var a=c("1d80"),r=c("5899"),s="["+r+"]",n=RegExp("^"+s+s+"*"),o=RegExp(s+s+"*$"),d=function(t){return function(e){var c=String(a(e));return 1&t&&(c=c.replace(n,"")),2&t&&(c=c.replace(o,"")),c}};t.exports={start:d(1),end:d(2),trim:d(3)}},7156:function(t,e,c){var a=c("861d"),r=c("d2bb");t.exports=function(t,e,c){var s,n;return r&&"function"==typeof(s=e.constructor)&&s!==c&&a(n=s.prototype)&&n!==c.prototype&&r(t,n),t}},a9e3:function(t,e,c){"use strict";var a=c("83ab"),r=c("da84"),s=c("94ca"),n=c("6eeb"),o=c("5135"),d=c("c6b6"),l=c("7156"),i=c("c04e"),b=c("d039"),h=c("7c73"),O=c("241c").f,u=c("06cf").f,p=c("9bf2").f,j=c("58a8").trim,m="Number",f=r[m],g=f.prototype,w=d(h(g))==m,x=function(t){var e,c,a,r,s,n,o,d,l=i(t,!1);if("string"==typeof l&&l.length>2)if(l=j(l),e=l.charCodeAt(0),43===e||45===e){if(c=l.charCodeAt(2),88===c||120===c)return NaN}else if(48===e){switch(l.charCodeAt(1)){case 66:case 98:a=2,r=49;break;case 79:case 111:a=8,r=55;break;default:return+l}for(s=l.slice(2),n=s.length,o=0;o<n;o++)if(d=s.charCodeAt(o),d<48||d>r)return NaN;return parseInt(s,a)}return+l};if(s(m,!f(" 0o1")||!f("0b1")||f("+0x1"))){for(var y,v=function(t){var e=arguments.length<1?0:t,c=this;return c instanceof v&&(w?b((function(){g.valueOf.call(c)})):d(c)!=m)?l(new f(x(e)),c,v):x(e)},_=a?O(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),S=0;_.length>S;S++)o(f,y=_[S])&&!o(v,y)&&p(v,y,u(f,y));v.prototype=g,g.constructor=v,n(r,m,v)}},b0c0:function(t,e,c){var a=c("83ab"),r=c("9bf2").f,s=Function.prototype,n=s.toString,o=/^\s*function ([^ (]*)/,d="name";a&&!(d in s)&&r(s,d,{configurable:!0,get:function(){try{return n.call(this).match(o)[1]}catch(t){return""}}})}}]);
//# sourceMappingURL=chunk-2e51dccc.46314e68.js.map