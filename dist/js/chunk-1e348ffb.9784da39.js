(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e348ffb"],{"0c8f":function(t,e,a){"use strict";a.r(e);var n=a("7a23"),o={class:"container pageContent py-5 overflow-hidden"},c=Object(n["h"])("h1",{class:"text-center fw-bold m-0 pb-5"},"優惠券管理",-1),l={class:"row justify-content-between pb-2"},s={class:"col-md-6 col-lg-4 col-xl-3 pb-1"},i={class:"input-group"},u={class:"col-md-6 text-end pb-1"},d=Object(n["h"])("i",{class:"bi bi-arrow-counterclockwise"},null,-1),r={class:"table-responsiv"},p={class:"table table-hover rounded overflow-hidden shadow-sm\n          text-break text-center"},b=Object(n["h"])("thead",{class:"table-dark align-middle"},[Object(n["h"])("tr",null,[Object(n["h"])("td",null,"優惠券名稱"),Object(n["h"])("td",null,"優惠碼"),Object(n["h"])("td",null,"折扣 % 數"),Object(n["h"])("td",null,"到期日"),Object(n["h"])("td",null,"狀態"),Object(n["h"])("td",null,"操作"),Object(n["h"])("td",null,"刪除")])],-1),h={"data-title":"優惠券名稱"},m={"data-title":"優惠碼"},f={"data-title":"折扣 % 數"},O={"data-title":"到期日"},j={"data-title":"操作"},g={"data-title":"刪除"};function w(t,e,a,w,C,v){var D=Object(n["A"])("DashboarLoading"),S=Object(n["A"])("Pagination"),x=Object(n["A"])("CouponModal");return Object(n["v"])(),Object(n["d"])(n["a"],null,[Object(n["h"])(D,{status:C.loadingStatus},null,8,["status"]),Object(n["h"])("section",o,[c,Object(n["h"])("div",l,[Object(n["h"])("span",s,[Object(n["h"])("span",i,[Object(n["N"])(Object(n["h"])("input",{type:"text",class:"form-control",placeholder:"請輸入優惠碼","aria-label":"search","aria-describedby":"basic-addon1","onUpdate:modelValue":e[1]||(e[1]=function(t){return C.couponSearch=t})},null,512),[[n["J"],C.couponSearch]]),Object(n["h"])("i",{class:"bi bi-x-lg fs-6 btn btn-outline-brown input-group-text",onClick:e[2]||(e[2]=function(){return v.clearSearch&&v.clearSearch.apply(v,arguments)})})])]),Object(n["h"])("span",u,[Object(n["h"])("button",{class:"btn btn-brown",onClick:e[3]||(e[3]=function(t){return v.opanCouponModal(!0)})}," 新增優惠券 "),Object(n["h"])("button",{type:"button",class:"btn btn-outline-brown btn-sm ms-1 fs-5",onClick:e[4]||(e[4]=function(){return v.resetData&&v.resetData.apply(v,arguments)})},[d])])]),Object(n["h"])("div",r,[Object(n["h"])("table",p,[b,Object(n["h"])("tbody",null,[(Object(n["v"])(!0),Object(n["d"])(n["a"],null,Object(n["z"])(v.filterCoupon,(function(e){return Object(n["v"])(),Object(n["d"])("tr",{key:e.id},[Object(n["h"])("td",h,Object(n["D"])(e.title),1),Object(n["h"])("td",m,Object(n["D"])(e.code),1),Object(n["h"])("td",f,Object(n["D"])(e.percent)+"% ",1),Object(n["h"])("td",O,Object(n["D"])(t.$filters.date(e.due_date)),1),Object(n["h"])("td",{"data-title":"狀態",class:{"text-warning":e.is_enabled,"text-gray":!e.is_enabled}},Object(n["D"])(e.is_enabled?"已啟用":"未啟用"),3),Object(n["h"])("td",j,[Object(n["h"])("button",{class:"btn btn-outline-brown px-2 py-1",onClick:function(t){return v.opanCouponModal(!1,e)}}," 修改 ",8,["onClick"])]),Object(n["h"])("td",g,[Object(n["h"])("i",{class:"bi bi-trash-fill btn btn-outline-danger",onClick:function(t){return v.delCouponSwalFn(e,"one")}},null,8,["onClick"])])])})),128))])])]),Object(n["h"])(S,{"pagination-isShow":C.isPaginationShow,"pagination-page":C.couponPagination,onGetData:v.getCoupons},null,8,["pagination-isShow","pagination-page","onGetData"]),Object(n["h"])(x,{ref:"couponModal","modal-coupon":C.updataCouponData,"modal-isNew":C.isNew,"modal-btn-status":C.btnStatus,onModalUpdateCoupon:v.updateCoupon},null,8,["modal-coupon","modal-isNew","modal-btn-status","onModalUpdateCoupon"])])],64)}a("4de4"),a("ac1f"),a("466d"),a("99af");var C=a("4897"),v=a("fd99"),D=a("55ea"),S={class:"modal fade m-0",id:"productModal",tabindex:"-1","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false",ref:"modal"},x={class:"modal-dialog modal-dialog-centered"},k={class:"modal-content coupon_width mx-auto"},y={class:"modal-header bg-warning text-brown-500"},M={class:"modal-title",id:"staticBackdropLabel"},N=Object(n["h"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),_={key:0,class:"modal-body"},P={class:"col-12"},V=Object(n["h"])("label",{for:"modalTitle",class:"form-label p-1 m-0"},[Object(n["g"])(" 優惠券名稱"),Object(n["h"])("span",{class:"text-danger fw-bold"},"*")],-1),B={class:"col-12"},I=Object(n["h"])("label",{for:"modalCode",class:"form-label p-1 m-0"},[Object(n["g"])(" 優惠碼"),Object(n["h"])("span",{class:"text-danger fw-bold"},"*")],-1),U={class:"col-12"},$=Object(n["h"])("label",{for:"modalPercent",class:"form-label p-1 m-0"},[Object(n["g"])(" 折扣 % 數"),Object(n["h"])("span",{class:"text-danger fw-bold"},"*")],-1),F={class:"col-12"},A=Object(n["h"])("label",{for:"modalDueDate",class:"form-label p-1 m-0"},[Object(n["g"])(" 到期日"),Object(n["h"])("span",{class:"text-danger fw-bold"},"*")],-1),J={class:"col-12 form-check\n                d-flex justify-content-end align-items-center"},T=Object(n["h"])("label",{for:"enabledStatus"},[Object(n["g"])(" 是否啟用"),Object(n["h"])("span",{class:"text-danger fw-bold"},"*")],-1),q=Object(n["h"])("span",{class:"text-danger text-end fw-bold mt-1"}," * 為必填項目 ",-1),E={class:"modal-footer"},G=Object(n["h"])("button",{type:"button",class:"btn btn-outline-brown","data-bs-dismiss":"modal"}," 關閉 ",-1);function L(t,e,a,o,c,l){var s=Object(n["A"])("Field"),i=Object(n["A"])("error-message"),u=Object(n["A"])("Form");return Object(n["v"])(),Object(n["d"])("section",S,[Object(n["h"])("section",x,[Object(n["h"])("main",k,[Object(n["h"])("div",y,[Object(n["h"])("h5",M,Object(n["D"])(c.isNewCoupon?"新增優惠券":"修改優惠券"),1),N]),c.tempCouponData?(Object(n["v"])(),Object(n["d"])("section",_,[Object(n["h"])(u,{ref:"couponForm",class:"row",onChange:l.checkInputValue},{default:Object(n["M"])((function(t){var a=t.errors;return[Object(n["h"])("span",P,[V,Object(n["h"])(s,{type:"text",name:"優惠券名稱",placeholder:"請輸入優惠券名稱",id:"modalTitle",class:["form-control mb-2",{"is-invalid":a["優惠券名稱"]}],rules:"required",modelValue:c.tempCouponData.title,"onUpdate:modelValue":e[1]||(e[1]=function(t){return c.tempCouponData.title=t})},null,8,["class","modelValue"]),Object(n["h"])(i,{name:"優惠券名稱",class:"invalid-feedback mb-1"})]),Object(n["h"])("span",B,[I,Object(n["h"])(s,{type:"text",name:"優惠碼",placeholder:"請輸入優惠碼",id:"modalCode",class:["form-control mb-2",{"is-invalid":a["優惠碼"]}],rules:"required",modelValue:c.tempCouponData.code,"onUpdate:modelValue":e[2]||(e[2]=function(t){return c.tempCouponData.code=t})},null,8,["class","modelValue"]),Object(n["h"])(i,{name:"優惠碼",class:"invalid-feedback mb-1"})]),Object(n["h"])("span",U,[$,Object(n["h"])(s,{type:"number",min:"1",max:"99",name:"折扣 % 數",id:"modalPercent",class:["form-control",{"is-invalid":a["折扣 % 數"]}],rules:"required|numeric|numeric",modelValue:c.tempCouponData.percent,"onUpdate:modelValue":e[3]||(e[3]=function(t){return c.tempCouponData.percent=t}),modelModifiers:{number:!0}},null,8,["class","modelValue"]),Object(n["h"])(i,{name:"折扣 % 數",class:"invalid-feedback mb-1"})]),Object(n["h"])("span",F,[A,Object(n["N"])(Object(n["h"])("input",{type:"date",id:"modalDueDate",name:"到期日",class:"form-control mb-2",placeholder:"請輸入到期日","onUpdate:modelValue":e[4]||(e[4]=function(t){return c.tempDueDate=t})},null,512),[[n["J"],c.tempDueDate]])]),Object(n["h"])("span",J,[Object(n["N"])(Object(n["h"])("input",{type:"checkbox",id:"enabledStatus",name:"啟用狀態",value:"啟用狀態",class:"form-check-input m-2 me-1","true-value":1,"false-value":0,"onUpdate:modelValue":e[5]||(e[5]=function(t){return c.tempCouponData.is_enabled=t})},null,512),[[n["G"],c.tempCouponData.is_enabled]]),T]),q]})),_:1},8,["onChange"])])):Object(n["e"])("",!0),Object(n["h"])("div",E,[G,Object(n["h"])("button",{type:"button",class:"btn btn-warning text-brown-500",disabled:c.newBtnStatus,onClick:e[6]||(e[6]=function(e){return t.$emit("modalUpdateCoupon",c.tempCouponData)})},Object(n["D"])(a.modalIsNew?"確定新增":"儲存變更"),9,["disabled"])])])])],512)}var R=a("3835"),z=(a("a9e3"),a("1276"),a("9129"),a("7c2b")),Y=a.n(z),H={name:"DashboarCouponModal",data:function(){return{couponModal:"",newBtnStatus:Boolean,tempCouponData:{title:"",code:"",percent:1,due_date:Math.floor(Date.now()/1e3),is_enabled:1},isNewCoupon:!0,tempDueDate:Number}},props:["modalCoupon","modalIsNew","modalBtnStatus"],watch:{modalCoupon:function(){this.tempCouponData=this.modalCoupon;var t=new Date(1e3*this.modalCoupon.due_date).toISOString().split("T"),e=Object(R["a"])(t,1);this.tempDueDate=e[0]},modalIsNew:function(){this.isNewCoupon=this.modalIsNew},tempDueDate:function(){var t=Math.floor(new Date(this.tempDueDate)/1e3);this.tempCouponData.due_date=t},modalBtnStatus:function(){this.newBtnStatus=this.modalBtnStatus}},emits:["modalUpdateCoupon"],methods:{openCouponModal:function(){this.couponModal.show()},hideCouponModal:function(){this.couponModal.hide()},resetForm:function(){this.$refs.couponForm.resetForm()},checkInputValue:function(){var t=this.tempCouponData,e=t.title,a=t.code,n=t.percent;0===this.tempCouponData.percent&&Object(C["c"])("折扣數不可小於 1","error"),""===e||""===a||""===n||0===n||Number.isNaN(this.tempCouponData.due_date)?this.newBtnStatus=!0:this.newBtnStatus=!1}},mounted:function(){this.couponModal=new Y.a(this.$refs.modal)}};a("533f");H.render=L;var K=H,Q={name:"DashboardCoupon",data:function(){return{loadingStatus:!1,btnStatus:Boolean,couponSearch:"",couponPagination:{},couponDatas:[],isNew:Boolean,updataCouponData:{},isPaginationShow:!0}},watch:{couponSearch:function(){""!==this.couponSearch?this.filterCoupon.length>9?this.isPaginationShow=!0:this.isPaginationShow=!1:""===this.couponSearch&&(this.isPaginationShow=!0)}},computed:{filterCoupon:function(){var t=this;return this.couponDatas.filter((function(e){return e.code.match(t.couponSearch)}))}},components:{DashboarLoading:v["a"],Pagination:D["a"],CouponModal:K},methods:{getCoupons:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("toriha_vuetestapi","/admin/coupons?page=").concat(e);this.loadingStatus=!0,this.$http.get(a).then((function(e){e.data.success?(t.couponDatas=e.data.coupons,t.couponPagination=e.data.pagination,t.couponPagination.total_pages>1&&(t.isPaginationShow=!0),t.loadingStatus=!1):(Object(C["c"])("資料取得失敗","error"),t.loadingStatus=!1)})).catch((function(){Object(C["c"])("資料取得失敗","error"),t.loadingStatus=!1}))},opanCouponModal:function(t,e){t?(this.isNew=!0,this.btnStatus=!0,this.$refs.couponModal.resetForm(),this.updataCouponData={title:"",code:"",percent:1,due_date:Math.floor(Date.now()/1e3),is_enabled:0}):(this.isNew=!1,this.btnStatus=!1,this.updataCouponData=JSON.parse(JSON.stringify(e))),this.$refs.couponModal.openCouponModal()},updateCoupon:function(t){var e=this,a="",n="";this.loadingStatus=!0,this.isNew?(a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("toriha_vuetestapi","/admin/coupon"),n="post"):(a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("toriha_vuetestapi","/admin/coupon/").concat(t.id),n="put"),this.$http[n](a,{data:t}).then((function(t){t.data.success?(Object(C["c"])(t.data.message,"success"),e.getCoupons(),e.$refs.couponModal.hideCouponModal()):(Object(C["c"])(t.data.message,"error"),e.loadingStatus=!1)})).catch((function(){Object(C["c"])("操作失敗","error"),e.loadingStatus=!1}))},delCoupon:function(t,e){var a=this,n="".concat("https://vue3-course-api.hexschool.io","/api/").concat("toriha_vuetestapi","/admin/coupon/").concat(e);this.loadingStatus=!0,this.$http.delete(n).then((function(t){t.data.success?(Object(C["c"])(t.data.message,"success"),a.getCoupons()):(Object(C["c"])(t.data.message,"error"),a.loadingStatus=!1)})).catch((function(){Object(C["c"])("操作失敗","error"),a.loadingStatus=!1}))},delCouponSwalFn:function(t,e){var a=t.title,n=t.id;Object(C["a"])(a,n,this.delCoupon,e)},resetData:function(){Object(C["c"])("正在重整資料","info"),this.clearSearch(),this.getCoupons()},clearSearch:function(){this.couponSearch=""}},mounted:function(){this.getCoupons(),this.$refs.couponModal.resetForm()}};Q.render=w;e["default"]=Q},1276:function(t,e,a){"use strict";var n=a("d784"),o=a("44e7"),c=a("825a"),l=a("1d80"),s=a("4840"),i=a("8aa5"),u=a("50c4"),d=a("14c3"),r=a("9263"),p=a("9f7f"),b=a("d039"),h=p.UNSUPPORTED_Y,m=[].push,f=Math.min,O=4294967295,j=!b((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var a="ab".split(t);return 2!==a.length||"a"!==a[0]||"b"!==a[1]}));n("split",(function(t,e,a){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,a){var n=String(l(this)),c=void 0===a?O:a>>>0;if(0===c)return[];if(void 0===t)return[n];if(!o(t))return e.call(n,t,c);var s,i,u,d=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),b=0,h=new RegExp(t.source,p+"g");while(s=r.call(h,n)){if(i=h.lastIndex,i>b&&(d.push(n.slice(b,s.index)),s.length>1&&s.index<n.length&&m.apply(d,s.slice(1)),u=s[0].length,b=i,d.length>=c))break;h.lastIndex===s.index&&h.lastIndex++}return b===n.length?!u&&h.test("")||d.push(""):d.push(n.slice(b)),d.length>c?d.slice(0,c):d}:"0".split(void 0,0).length?function(t,a){return void 0===t&&0===a?[]:e.call(this,t,a)}:e,[function(e,a){var o=l(this),c=void 0==e?void 0:e[t];return void 0!==c?c.call(e,o,a):n.call(String(o),e,a)},function(t,o){var l=a(n,this,t,o,n!==e);if(l.done)return l.value;var r=c(this),p=String(t),b=s(r,RegExp),m=r.unicode,j=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.unicode?"u":"")+(h?"g":"y"),g=new b(h?"^(?:"+r.source+")":r,j),w=void 0===o?O:o>>>0;if(0===w)return[];if(0===p.length)return null===d(g,p)?[p]:[];var C=0,v=0,D=[];while(v<p.length){g.lastIndex=h?0:v;var S,x=d(g,h?p.slice(v):p);if(null===x||(S=f(u(g.lastIndex+(h?v:0)),p.length))===C)v=i(p,v,m);else{if(D.push(p.slice(C,v)),D.length===w)return D;for(var k=1;k<=x.length-1;k++)if(D.push(x[k]),D.length===w)return D;v=C=S}}return D.push(p.slice(C)),D}]}),!j,h)},"533f":function(t,e,a){"use strict";a("e95f")},9129:function(t,e,a){var n=a("23e7");n({target:"Number",stat:!0},{isNaN:function(t){return t!=t}})},e95f:function(t,e,a){}}]);
//# sourceMappingURL=chunk-1e348ffb.9784da39.js.map